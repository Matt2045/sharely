
services:
  sharely:
    env_file:
      - .env.production
    build:
      context: .
      dockerfile: Dockerfile
      args:
        # Build-Zeit Variablen (öffentlich - gehen ins Frontend)
        VITE_SYNCFUSION_LICENSE_KEY: ${VITE_SYNCFUSION_LICENSE_KEY}
        VITE_APPWRITE_PROJECT_ID: ${VITE_APPWRITE_PROJECT_ID}
        VITE_APPWRITE_ENDPOINT_API: ${VITE_APPWRITE_ENDPOINT_API}
        VITE_APPWRITE_PINTEREST_DATABASE_ID: ${VITE_APPWRITE_PINTEREST_DATABASE_ID}
        VITE_APPWRITE_USERS_COLLECTION: ${VITE_APPWRITE_USERS_COLLECTION}
        VITE_APPWRITE_PINS_COLLECTION: ${VITE_APPWRITE_PINS_COLLECTION}
        VITE_APPWRITE_SAVED_PINS_COLLECTION: ${VITE_APPWRITE_SAVED_PINS_COLLECTION}
        VITE_APPWRITE_LIKED_PINS_COLLECTION: ${VITE_APPWRITE_LIKED_PINS_COLLECTION}
        VITE_APPWRITE_STORAGE_BUCKET_ID: ${VITE_APPWRITE_STORAGE_BUCKET_ID}
        VITE_UNSPLASH_API_ACCESS_KEY: ${VITE_UNSPLASH_API_ACCESS_KEY}
    container_name: sharely-app
    restart: unless-stopped
    ports:
      - "3000:3000"
    environment:
      # Runtime Variablen (Secrets - nur auf dem Server verfügbar)
      - GEMINI_API_KEY=${GEMINI_API_KEY}
      # Öffentliche Variablen für SSR
      - VITE_APPWRITE_PROJECT_ID=${VITE_APPWRITE_PROJECT_ID}
      - VITE_APPWRITE_ENDPOINT_API=${VITE_APPWRITE_ENDPOINT_API}
      - VITE_APPWRITE_PINTEREST_DATABASE_ID=${VITE_APPWRITE_PINTEREST_DATABASE_ID}
      - VITE_APPWRITE_USERS_COLLECTION=${VITE_APPWRITE_USERS_COLLECTION}
      - VITE_APPWRITE_PINS_COLLECTION=${VITE_APPWRITE_PINS_COLLECTION}
      - VITE_APPWRITE_SAVED_PINS_COLLECTION=${VITE_APPWRITE_SAVED_PINS_COLLECTION}
      - VITE_APPWRITE_LIKED_PINS_COLLECTION=${VITE_APPWRITE_LIKED_PINS_COLLECTION}
      - VITE_APPWRITE_STORAGE_BUCKET_ID=${VITE_APPWRITE_STORAGE_BUCKET_ID}
      - VITE_UNSPLASH_API_ACCESS_KEY=${VITE_UNSPLASH_API_ACCESS_KEY}
      - VITE_SYNCFUSION_LICENSE_KEY=${VITE_SYNCFUSION_LICENSE_KEY}
    networks:
      - sharely-network

networks:
  sharely-network:
    driver: bridge